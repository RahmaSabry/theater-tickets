<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Theater Tickets</title>
</head>
<body>

  <h2>ğŸ“¸ Scan Ticket</h2>
<button onclick="location.href='scan.html'">Go to Scan Page</button>
  <h1>ğŸŸï¸ Theater Ticket Generator</h1>

  <h2>Batch Ticket Generator</h2>
<form id="batchForm">
  <input type="number" id="price" placeholder="Ø§Ø¯Ø®Ù„ Ø³Ø¹Ø± Ø§Ù„ØªØ°ÙƒØ±Ø©" required>
  <input type="number" id="batchCount" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„ØªØ°Ø§ÙƒØ±" required>
  <button type="submit">Ø¥Ù†Ø´Ø§Ø¡ ØªØ°Ø§ÙƒØ± Ù…ØªØ¹Ø¯Ø¯Ø©  </button>
</form>
<h2>Generated Tickets</h2>
<div id="ticketList"></div>


  <h2>Tickets:</h2>
  <ul id="ticketList"></ul>
<script>
  const batchForm = document.getElementById("batchForm");
  const ticketList = document.getElementById("ticketList");

  batchForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const price = document.getElementById("price").value;
    const count = parseInt(document.getElementById("batchCount").value);

    const res = await fetch("/ticket/create", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ user, count })
    });

    const data = await res.json();
    ticketList.innerHTML = "";

    data.tickets.forEach(ticket => {
      const div = document.createElement("div");
      div.innerHTML = `
        <p><b>${ticket.user}</b></p>
        <img src="${ticket.qrImage}" width="150" />
        <br>
        <a href="${ticket.qrImage}" download="ticket_${ticket.ticketId}.png">
          <button>Download QR</button>
        </a>
        <hr>
      `;
      ticketList.appendChild(div);
    });
  });
</script>
  <!-- <script>
    const list = document.getElementById("ticketList");


    async function loadTickets() {
      list.innerHTML = "";
      const res = await fetch("/ticket");
      const tickets = await res.json();

      tickets.forEach(t => {
        const li = document.createElement("li");
        console.log(t);
        
        li.innerHTML = `
          ${t.user} - ${t.used ? "âœ… Used" : "ğŸŸ¢ Active"} 
          <a href="/ticket/${t._id}" target="_blank">[QR]</a>
          <a href="/ticket/scan/${t._id}" target="_blank">[Scan]</a>
        `;
        list.appendChild(li);
      });
    }

    loadTickets();
  </script> -->
</body>
</html>
